<div class="content">
  <!-- FORMULARIO -->
  <div class="container form">
    <div style="text-align: center;" class="col">
      <h1>{{title}}</h1>
    </div>

    <form>
      <label for="plato">Nombre del Plato</label>
      <input type="text" name="plato" id="plato" [formControl]="cuadroplato" required>
      <div class="alert alert-danger mt-2" [hidden]="cuadroplato.valid || cuadroplato.pristine">
        Es necesario poner nombre a la receta
      </div>
      <div class="form-group">
        <!-- ingredientes -->

        <mat-form-field>
          <mat-label>Ingredientes</mat-label>
          <mat-select [formControl]="listaIngredientes" (selectionChange)="actualizarSeleccionIngredientes($event)" multiple>
            <mat-option *ngFor="let ing of ingredientes" [value]="ing">
              {{ ing.nombre }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        

        <div class="alert alert-danger mt-2" [hidden]="listaIngredientes.valid || listaIngredientes.pristine">
          Selecciona algún ingrediente
        </div>

        <!-- Ingredientes Nuevos -->

        <div class="add">
          <input type="text" [formControl]="cuadroNombre" placeholder="Añadir ingrediente..." name="nuevoIngrediente">
          <button (click)="agregarIngrediente()">+</button>
        </div>

        <!-- CANTIDADES -->

        <div *ngFor="let ing of ingredientesSelec">
          <label [for]="ing.nombre"> {{ ing.nombre }} </label>
          <input
            type="text"
            [id]="ing.nombre"
            [formControl]="cantidades[ing.nombre]"
            placeholder="Cantidad de {{ ing.nombre }}"
            required
          >
          <div
            class="alert alert-danger mt-2"
            [hidden]="cantidades[ing.nombre].valid || cantidades[ing.nombre].pristine"
          >
            La cantidad de {{ ing.nombre }} es requerida.
          </div>
        </div>

      </div>


      <br>
      <br>
      <label for="prep">Preparación:</label>
      <textarea name="prep" id="prep" [formControl]="cuadropreparacion" required></textarea>
      <div class="alert alert-danger mt-2" [hidden]="cuadropreparacion.valid || cuadropreparacion.pristine">
        Este campo no puede estar vacío.
      </div>
      <br><br>
      <input type="submit" value="Guardar Receta" title="Rellena todos los campos" [disabled]="listaIngredientes.invalid || cuadroplato.invalid || cuadropreparacion.invalid" (click)="incluirReceta()">
    </form>


  </div>

  <!-- RECETA SEGÚN LA VAS ESCRIBIENDO -->

  <div class="receta">
    <h2>{{cuadroplato.value}}</h2>

    <h3 *ngIf="ingredientesSelec.length>0">Ingredientes</h3>

    <ul *ngIf="ingredientesSelec.length>0">@for (ing of ingredientesSelec; track $index) {
      <li>
        {{ ing.nombre }} - {{cantidades[ing.nombre].value}}</li>}
    </ul>

    <p>{{cuadropreparacion.value}}</p>

  </div>

</div>